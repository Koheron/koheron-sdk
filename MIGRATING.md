**Instruments built with v1 can run on a v0 OS. However, the v1 OS does not
support running v0 instruments.** The v1 runtime still provides an
`/dev/xdevcfg` fallback so you can boot newer instruments on an older kernel,
but the v1 OS images no longer ship the legacy driver.

## Move from /dev/xdevcfg to FPGA manager

`/dev/xdevcfg` is no longer present on the OS. Each instrument now ships a
device tree overlay (`pl.dtbo`) alongside the bitstream (`<instrument>.bit.bin`)
and relies on the Linux FPGA Manager overlay interface to load the bitstream
and configure the PL clocks.

The device tree overlay can be customized to access Linux drivers such as `/dev/uio*` or `/dev/mem_wc*`.

## config.yml is split between config.mk and memory.yml

```
# V0
make CONFIG=examples/alpha250/fft/config.yml

#V1
make CFG=examples/alpha250/fft/config.mk
```

Build settings live in `config.mk` (instrument name, board path, Vivado cores,
drivers, web assets, etc.). The memory map, register lists and tunable
parameters now live in `memory.yml`, which is consumed by `make.py` to generate
`memory.tcl`, `memory.hpp` and `memory.dtsi`.


## Device tree overlay

`pl.dtbo` is compiled from `pl_wrap.dts`:
```
/dts-v1/;
/plugin/;
/include/ "pl.dtsi"         /* Generated by Vivado/Vitis */
/include/ "memory.dtsi"     /* Generated from the `compatible` attributes in memory.yml */
/include/ "override.dtsi"   /* User defined */
```

### Example 1: Map a reserved region of RAM using the mem-wc driver

```
memory:
- name: ram
offset: 0x1E00_0000
range: 32M
compatible: "koheron,mem-wc-1.0"
dev: /dev/mem_wc
```

The `compatible: "koheron,mem-wc-1.0` attribute tells the build system to add a fragment in `memory.dtsi`:

```dtsi
/* memory.dtsi */
&amba {
    #address-cells = <1>;
    #size-cells    = <1>;
    kmem_ram: ram@1E000000 {
        compatible = "koheron,mem-wc-1.0";
        reg = <0x1E000000 0x04000000>;
    };
};
```

The `dev: /dev/mem_wc` attribute tells the server to use `/dev/mem_wc@0x1E000000` instead of the default `/dev/mem`

### Example 2: Interrupt access in the userspace

```
# memory.yml
memory:
- name: fifo
  range: 64K
  offset: 0x43C0_0000
  dev: /dev/uio
```

```dtsi
/* override.dtsi */
&axi_fifo_mm_s_0 {
    compatible = "generic-uio";
    status = "okay";
    linux,uio-name = "irq-fifo";
    linux,driver-override = "uio_pdrv_genirq";
};
```

The fragment defined in override.dtsi allows Linux to bind the FIFO to a /dev/uio* device.
The `dev: /dev/uio` attribute tells the server to map to a `/dev/uio*` device that matches the range and offset attributes.

## Other new features

* The image can be built in parallel without `sudo`:

  ```
  make CFG=examples/alpha250/fft/config.mk -j image
  ```